namespace = redrising

@tier2unityreward = 12
@tier2unitymin = 150
@tier2unitymax = 1000
@timetodarrowafteraresdays = 7200
@timebetweenunresteventsdays = 1500
@timetodarkrevoltdays = 7800
@timetofreedomdays = 3600

#Institute Questline

country_event = {
	id = redrising.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit = {	has_valid_civic = civic_redrising_noble_lie
							NOT = { has_country_flag = redrising_institute_offered }
							has_country_flag = redrising_society
							OR = {
								has_ethic = ethic_fanatic_authoritarian
								has_ethic = ethic_authoritarian
							}						 
						}
			if = {
			limit = {
				is_ai = yes
			}
			set_country_flag = redrising_institute_offered
			country_event = { id = redrising.3 }
			}
			if = {
			limit = {
				is_ai = no
			}
			set_country_flag = redrising_institute_offered
			country_event = { id = redrising.4 }
			}
		}
		else = {
			country_event = { id = redrising.43 }
		}		
	}
}

#2 -> 4

country_event = {
	id = redrising.3
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit = { has_valid_civic = civic_redrising_noble_lie
									has_country_flag = redrising_society
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_authoritarian
									}
						
						}
			set_country_flag = redrising_institute_pscarred_built
			add_modifier = { 
							modifier = redrising_institute_pscarred_built
							days = -1
							}
		}
		else = {
				country_event = { id = redrising.43 }
		}
	}
}

country_event = {
	id = redrising.4
	hide_window = no
	is_triggered_only = yes
	location = root
	
	title = institute.4
	desc = institute.4.desc
	picture = GFX_evt_arguing_senate
	
option = {
		name = "redrising.4.a"
		capital_scope = { save_event_target_as = capital_location }
		enable_special_project = {
				name = "REDRISING_INSTITUTE_1"
				location = event_target:capital_location
				owner = root
		}		
	}
option = {
		name = "redrising.4.b"
		add_monthly_resource_mult = {
			resource = unity
			value = @tier2unityreward
			min = @tier2unitymin
			max = @tier2unitymax
		}
	}
}

country_event = {
	id = redrising.5
	hide_window = no
	is_triggered_only = yes
	
	title = institute.5
	desc = institute.5.desc
	picture = GFX_evt_medieval_alien_civilization

	option = {
		name = "redrising.5.a"
		custom_tooltip = redrising.1.a.tooltip		
		add_modifier = { 
			modifier = redrising_institute_pscarred_built
			days = -1
		}
	}
}

#6 removed

#7 removed

#Obsidan Event Chain

country_event = {
	id = redrising.8
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
	if = { limit = { has_valid_civic = civic_redrising_noble_lie
									has_country_flag = redrising_society
									NOT = { has_country_flag = redrising_society_bodies_quest }
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_authoritarian
									}								
					}
		if = {
			limit = {
				is_ai = yes
			}
			country_event = { id = redrising.10 }
			
		}
		if = {
			limit = {
				is_ai = no
			}
			country_event = { id = redrising.11 }
		}
	}
	else = {
				country_event = { id = redrising.43 }
		}
	}
}

#9 -> 11

country_event = {
	id = redrising.10
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		
		if = { limit = {	NOT = {
								any_owned_planet = {
									is_colony = yes
									count_owned_pop = {
										count > 2
									}	
								}
							}
						}
			country_event = {	id = redrising.10 
								days = 30
							}
		}
		if = { limit = {	any_owned_planet = {
								is_colony = yes
								count_owned_pop = {
									count > 2
								}
							}
						}
			random_owned_planet = {
				limit = {
					is_colony = yes
					count_owned_pop = {
						count > 2
					}
				}
				save_event_target_as = obsidian_planet
			}
			create_species = {
				name = "NAME_obsidian_redrising"
				plural = "NAME_obsidians_redrising"
				adjective = "NAME_obsidian_redrising"
				namelist = HUM1
				class = HUM
				portrait = human
				traits = {
					trait = "trait_pc_continental_preference"
					trait = "trait_very_strong"
					trait = "trait_deviants"
					trait = "trait_redrising_warlike"
				}
			}

			last_created_species = {
				save_global_event_target_as = obsidian_redrising				
			}

			event_target:obsidian_planet = {
				while = {
					count = 2
						create_pop = {
							species = event_target:obsidian_redrising
							ethos = {
								ethic = "ethic_militarist"
							}
					}
				}
			}

			last_created_species = {
				set_citizenship_type = {
					country = root
					type = citizenship_slavery
					cooldown = no
				}
				set_military_service_type = {
					country = root
					type = military_service_limited	
					cooldown = no				
				}
				set_slavery_type = {
					country = root 
					type = slavery_military 
					cooldown = no
				}
			}
			
			set_country_flag = redrising_obsidians_deployed
			set_country_flag = redrising_society_bodies_quest
			country_event = {	id = redrising.15
								days = @timetodarkrevoltdays
								random = 500
							}
		}
	}
}

country_event = {
	id = redrising.11
	hide_window = no
	is_triggered_only = yes
	
	title = obsidian.11
	desc = obsidian.11.desc
	picture = GFX_evt_interior_battle

	immediate = {
		redrising_grab_red_species = yes
		set_country_flag = redrising_society_bodies_quest
		capital_scope = { save_event_target_as = capital_location }
	}
	
	option = {
		name = "redrising.11.a"		
		enable_special_project = {
				name = "REDRISING_OBSIDIAN_1"
				location = event_target:capital_location
				owner = root
		}
	
	}
	option = {
		name = "redrising.11.b"
		enable_special_project = {
			name = "REDRISING_GREY_1"
			location = event_target:capital_location
			owner = root
		}
	}
	option = {
		name = "redrising.11.c"
		custom_tooltip = redrising.11.c.tooltip
		hidden_effect = {
			every_owned_planet = {
				add_modifier = { 
					modifier = redrising_overstretched_grey_legions
					days = 3000
				}
			}	
		}			
	}
}

country_event = {
	id = redrising.12
	hide_window = no
	is_triggered_only = yes
	
	title = obsidian.12
	desc = obsidian.12.desc
	picture = GFX_evt_clones
	
	immediate = {
		country_event = { id = redrising.10 }
		every_owned_planet = {
			add_modifier = { 
				modifier = redrising_displace_reds
				days = 1800
			}
		}
	}

	option = {
		name = "redrising.12.a"
		custom_tooltip = redrising.12.a.tooltip
	}
}

country_event = {
	id = redrising.13
	hide_window = no
	is_triggered_only = yes
	
	title = obsidian.13
	desc = obsidian.13.desc
	picture = GFX_evt_colony_settlement
	
	immediate = {
		redrising_grab_red_species = yes
		country_event = { id = redrising.14 }
		every_owned_planet = {
			add_modifier = { 
				modifier = redrising_displace_reds
				days = 1800
			}
		}
	}

	option = {
		name = "redrising.13.a"
		custom_tooltip = redrising.13.a.tooltip
	}
}

country_event = {
	id = redrising.14
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit = { NOT = {
										any_owned_planet = {
											is_colony = yes
											count_owned_pop = {
												count > 2
											}							
										}
									}
			}
			country_event = { id = redrising.14 days = 30 }
		}
		if = { limit = {	any_owned_planet = {
								is_colony = yes
								count_owned_pop = {
									count > 2
								}					
							}
				} 
			random_owned_planet = {
				limit = {
					is_colony = yes
					count_owned_pop = {
						count > 2
					}
				}
				save_event_target_as = grey_planet
			}
			create_species = {
				name = "NAME_grey_redrising"
				plural = "NAME_greys_redrising"
				adjective = "NAME_grey_redrising"
				class = HUM
				portrait = human
				traits = {
					trait = "trait_pc_continental_preference"
					trait = "trait_traditional"
					trait = "trait_resilient"
				}
			}

			last_created_species = {
				save_event_target_as = grey_redrising
			}
			
			event_target:grey_planet = {
				while = {
					count = 2
						create_pop = {
							species = event_target:grey_redrising
							ethos = {
								ethic = "ethic_authoritarian"
							}
						}
				}
			}

			last_created_species = {
				set_citizenship_type = {
					country = root
					type = citizenship_limited
					cooldown = no
				}
				set_military_service_type = {
					country = root
					type = military_service_limited 
					cooldown = no              
				}
			}
			
			set_country_flag = redrising_greys_deployed
		}
	}
}

country_event = {
	id = redrising.15
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit =	{has_valid_civic = civic_redrising_noble_lie
									has_country_flag = redrising_society
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_authoritarian
						
							any_owned_pop = {
								is_same_species = event_target:obsidian_redrising
								is_enslaved = yes
							}
							}
						}
			country_event = { id = redrising.16 }
		}
	}
}

country_event = {
	id = redrising.16
	hide_window = no
	is_triggered_only = yes
	
	title = obsidian.16
	desc = obsidian.16.desc
	picture = GFX_evt_smugglers_in_bar

immediate = {
	country_event = {	id = redrising.17
							days = 360
					}	
}

option = {
		name = "redrising.16.a"
		add_modifier = { 
				modifier = redrising_something_wicked
				days = 360
			}
	}
}

country_event = {
	id = redrising.17
	hide_window = no
	is_triggered_only = yes
	
	title = obsidian.17
	desc = obsidian.17.desc
	picture = GFX_evt_ground_combat
	
	immediate = {
	set_country_flag = redrising_dark_revolt_begun
	capital_scope = {
		create_rebels = {
			name = obsidian_rebels
			ethos = { ethic = ethic_fanatic_militarist
						ethic = ethic_authoritarian }
			authority = root
			civics = { civic = civic_barbaric_despoilers
					   civic = civic_warrior_culture }
			origin = origin_separatists
			species = event_target:obsidian_redrising
			flag = random
			effect = {
				save_event_target_as = obsidian_rebels
				set_country_flag = redrising_obsidian_rebels
				establish_communications_no_message = root.owner
				root = {
					owner = {
						every_relation = {
							establish_communications_no_message = prevprevprev
						}
					}
				}
				declare_war = {
					target = root
					name = "NAME_redrising_The_Dark_Revolt"
					attacker_war_goal = wg_independence			
				}
			}
		}
	}
	every_owned_pop = {
		limit = { is_same_species = event_target:obsidian_rebels }
		planet = {
			if = {
				limit = {
					NOT = { has_planet_flag = redrising_dark_revolt }
				}
				set_planet_flag = redrising_dark_revolt
				add_planet_devastation = 30
			}
			create_army = {
				owner = event_target:obsidian_rebels
				species = event_target:obsidian_redrising
				type = "assault_army"
			}
			random_list = {
				20 = {	create_army = {
							owner = event_target:obsidian_rebels
							species = event_target:obsidian_redrising
							type = "assault_army"
						}
				}
				80 =	{ }
			}				
		}
	}
	
	if = {
		limit = {
			NOT = {
				any_owned_planet = {
					has_planet_flag = redrising_dark_revolt
				}
			}
		}
		country_event = {
			id = redrising.48
		}
	}	
	}
	
	option = {
		name = "redrising.17.a"
	}
}

country_event = {
	id = redrising.18
	hide_window = no
	is_triggered_only = yes

	trigger = {
		NOT = { has_country_flag = redrising_dark_revolt_ended }
	}
	
	title = obsidian.18
	desc = obsidian.18.desc
	picture = GFX_evt_alien_cavemen

	immediate = {
		set_country_flag = redrising_dark_revolt_ended
		remove_country_flag = redrising_dark_revolt_begun 
	}
	
option = {
name = "redrising.18.a"
custom_tooltip = redrising.18.a.tooltip
	hidden_effect = {
		every_owned_pop = {
			if = {	limit = { is_same_species = event_target:obsidian_redrising }
				wipe_pop_ethos = yes
				pop_change_ethic = ethic_spiritualist
			}
		}
		every_owned_planet = {
			modify_species = {
				species = event_target:obsidian_redrising		
				remove_trait = trait_deviants
			}
			last_created_species = { save_global_event_target_as = obsidian_redrising_2 }
			planet_event = { id = redrising.20 }
		}
	}
}
option = {
	name = "redrising.18.b"
	custom_tooltip = redrising.18.b.tooltip
	hidden_effect = {
		remove_country_flag = redrising_obsidians_deployed
		every_owned_pop = {
			if = {	limit = { is_same_species = event_target:obsidian_redrising }
				set_citizenship_type = {
					country = root
					type = citizenship_purge
					cooldown = no
				}
			}
		}
	}
}
}

#This = destroyed country
#From = optional, destroyer (country)
country_event = {
	id = redrising.19
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {	
		if = {
			limit = {
				any_country = {						
					has_country_flag = redrising_dark_revolt_begun						
				}
				has_country_flag = redrising_obsidian_rebels				
			}
			every_country = {
				limit = {
					has_country_flag = redrising_dark_revolt_begun				
				}
				country_event = { id = redrising.18 } #todo, redo with flags
			}		
		}
	}
}

planet_event = {
	id = redrising.20
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		modify_species = {
			species = event_target:obsidian_redrising_2
			add_trait = trait_nonadaptive			
		}
	}
}

#The Rising Event Chain

#Gateway
country_event = {
	id = redrising.21
	hide_window = yes
	
	trigger = {
		has_valid_civic = civic_redrising_noble_lie
		any_owned_pop = {
			is_enslaved = yes
		}
		NOT = { has_country_flag = redrising_sons_founded }
	}
		
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = redrising_sons_founded
		country_event = { id = redrising.23 }
	}
}

#Founding the Sons

country_event = {
	id = redrising.23
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		country_event = { id = redrising.24 }
		if = {
			limit = {
				has_origin = origin_redrising_society
			}
			country_event = { id = redrising.32 days = @timetodarrowafteraresdays random = 360 }
		}			
	}
}

country_event = {
	id = redrising.24
	hide_window = no
	is_triggered_only = yes
		
	title = rising.24
	desc = rising.24.desc
	picture = GFX_evt_redrising_ares_face
	
	immediate = {
		redrising_grab_red_species = yes
		start_situation = {
			type = situation_redrising_the_rising
			target = root
		}
		country_event = { id = redrising.40 days = @timebetweenunresteventsdays }
		set_country_flag = redrising_ares_insurrecting_0
	}
	
	option = {
		name = "redrising.24.a"
	}
}

#Unrest events 1-6

country_event = {
	id = redrising.25
	hide_window = no
	is_triggered_only = yes
	trigger = {
		has_valid_civic = civic_redrising_noble_lie
	}
	
	title = rising.25
	desc = rising.25.desc
	picture = GFX_evt_redrising_ares_face
	show_sound = event_public_unrest

	immediate = {
		redrising_grab_red_species = yes
		set_country_flag = redrising_ares_insurrecting_1
	}
		
	option = {
		name = "redrising.25.a"
		custom_tooltip = redrising.25.a.tooltip	
		hidden_effect = {
			while = {
				count = 3
				random_owned_pop = {
					limit = {
						is_enslaved = yes
					}
					kill_pop = yes
				}				
			}
		}		
	}

	option = {
		name = "redrising.25.b"
		custom_tooltip = redrising.25.b.tooltip	
		hidden_effect = {
			while = {
				count = 3
				random_owned_pop = {
					limit = {
						is_enslaved = yes
						NOT ={
							has_modifier = redrising_enlightened
						}						
					}
						add_modifier = {
							modifier = redrising_enlightened
							days = 3600				
						}
				}		
			}
		}		
	}
}

country_event = {
	id = redrising.26
	hide_window = no
	is_triggered_only = yes
	show_sound = event_ship_explosion
	
	title = rising.26
	desc = rising.26.desc
	picture = GFX_evt_burning_settlement
	
	immediate = {
		redrising_grab_red_species = yes
		set_country_flag = redrising_ares_insurrecting_2
	}

	option = {
		name = "redrising.26.a"
		custom_tooltip = "redrising.26.a.tooltip"
		hidden_effect = {
			every_owned_planet = {
			add_modifier = { modifier = redrising_unrest_bombing days = 1800 }
			}
		}		
	}
}

country_event = {
	id = redrising.27
	hide_window = no
	is_triggered_only = yes
	
	title = rising.27
	desc = rising.27.desc
	picture = GFX_evt_pirate_armada
	show_sound = event_public_unrest

	immediate = {
		set_country_flag = redrising_ares_insurrecting_3
	}
	
	option = {
		name = "redrising.27.a"
		add_resource = {
			unity = -1000
		}
		set_country_flag = redrising_conspiracy_grows
		custom_tooltip = redrising.27.a.tooltip
	}
	option = {
		name = "redrising.27.b"
		add_modifier = { modifier = redrising_unrest_embarrasment days = 3600 }
		custom_tooltip = redrising.27.b.tooltip
	}
}

country_event = {
	id = redrising.28
	hide_window = no
	is_triggered_only = yes
	
	title = rising.28
	desc = rising.28.desc
	picture = GFX_evt_redrising_domes
	show_sound = event_air_raid_siren

	immediate = {
		set_country_flag = redrising_ares_insurrecting_4
		capital_scope = {
			solar_system = {
				if = {
					limit = {
						any_system_planet = {
							is_planet_class = pc_nuked
							is_capital = no
							is_colony = no						}
					}
					random_system_planet = {
						limit = {
							is_planet_class = pc_nuked
							is_capital = no
							is_colony = no	
						}
						save_event_target_as = redrising_earth
					}
				}			
				else = {
					random_system_planet = {
						limit = {
							is_capital = no
							is_colony = no
						}
						save_event_target_as = redrising_earth
					}
				}				
			}
		}
	}
	
	option = {
		name = "redrising.28.a"
		custom_tooltip = "redrising.28.a.tooltip"
		hidden_effect = {
			every_owned_planet = {
				add_modifier = { modifier = redrising_unrest_prison days = 2400 }
			}
		}
	}
	
}

country_event = {
	id = redrising.29
	hide_window = no
	is_triggered_only = yes
	
	title = rising.29
	desc = rising.29.desc
	picture = GFX_evt_synth_sabotage

	immediate = {
		set_country_flag = redrising_ares_insurrecting_5
	}

	option = {
		name = "redrising.29.b"
		add_modifier = { modifier = redrising_unrest_crash days = 1800 }
	}
}

country_event = {
	id = redrising.30
	hide_window = no
	is_triggered_only = yes
	
	title = rising.30
	desc = rising.30.desc
	picture = GFX_evt_smugglers_in_bar
	show_sound = event_public_unrest

	immediate = {
		redrising_grab_red_species = yes
		set_country_flag = redrising_ares_insurrecting_6
	}

	option = {
		name = "redrising.30.a"
		add_modifier = { modifier = redrising_unrest_crackdown days = 3600 }
	}
	option = {
		name = "redrising.30.b"
		add_modifier = { modifier = redrising_unrest_patience days = 3600 }
	}
}

country_event = {
	id = redrising.31
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit = { has_country_flag = redrising_society }
			country_event = { id = redrising.33 }
		}
		else = { country_event = { id = redrising.43 }
		}		
	}
}

#Darrow

country_event = {
	id = redrising.32
	hide_window = no
	is_triggered_only = yes
	
	title = rising.32
	desc = {
		trigger = { has_country_flag = redrising_institute_pscarred_built }
		text = rising.32.desc
	}
	desc = {
		trigger = { NOT = { has_country_flag = redrising_institute_pscarred_built } }
		text = rising.32.2.desc
	}
	picture = {
		picture = GFX_evt_medieval_alien_civilization
		trigger = { has_country_flag = redrising_institute_pscarred_built }
	}
	picture = {
		picture = GFX_evt_throne_room
		trigger = { NOT = { has_country_flag = redrising_institute_pscarred_built } }
	}

	option = {
		name = "redrising.32.a"
		custom_tooltip = "redrising.32.a.tooltip"
		trigger = { 
			has_country_flag = redrising_institute_pscarred_built
			has_country_flag = redrising_society
		}
		create_leader = {
			class = general
			species = owner_main_species
			name = "NAME_darrow_au_andromedus"
			skill = 3
			set_age = 22
			gender = male
			background_ethic = ethic_militarist
			traits = {
				0 = subclass_general_invader
				1 = 
				2 = leader_trait_charismatic
				trait = 
				trait = trait_redrising_pscarred_general					
			}
		}
		last_created_leader = {
			set_leader_flag = redrising_darrow
		}
		hidden_effect = {
			country_event = { 
				id = redrising.33 days = 2900 random = 100 
			}
		}		
	}
	
	option = {
		name = "redrising.32.a.2"
		custom_tooltip = "redrising.32.a.2.tooltip.no_scars"
		trigger = {
			NOT = { has_country_flag = redrising_institute_pscarred_built }
			has_country_flag = redrising_society
		}
		create_leader = {
			class = general
			species = owner_main_species
			name = "NAME_darrow_au_andromedus"
			skill = 2
			set_age = 22
			gender = male
			traits = {
				trait = leader_trait_charismatic
			}
		}
		last_created_leader = {
			set_leader_flag = redrising_darrow
		}
		hidden_effect = {
			country_event = { 
				id = redrising.33 days = 2900 random = 100
			}
		}
	}

	option = {
		trigger = {
			NOT = { has_country_flag = redrising_society }			
		}
		name = DOTDOTDOT
		hidden_effect = {
			country_event = { 
				id = redrising.43 #todo, check if all checks like (has_country_flag = redrising_society) are OR between the origin and the civic
			}
		}
	}
}

#Death of Darrow
#Called either as random or by death

country_event = {
	id = redrising.33
	hide_window = no
	is_triggered_only = yes
	
	title = rising.33
	desc = rising.33.desc
	picture = GFX_evt_space_funeral
	
	trigger = {
		NOR = {
			has_country_flag = redrising_no_rising 
			ruler = {					
				has_leader_flag = redrising_darrow
			}
			ruler = {					
				has_leader_flag = redrising_became_soveriegn
			}
		}	
	}
	
	immediate = {
		if = {
			limit = {
				NOR = {
					has_country_flag = redrising_darrow_died
					ruler = {					
						has_leader_flag = redrising_darrow
					}
					ruler = {					
						has_leader_flag = redrising_became_soveriegn
					}
				}				
			}	
			set_country_flag = redrising_darrow_died
			every_owned_leader = {
				limit = {
					has_leader_flag = redrising_darrow
				}
				exile_leader_as = redrising_darrow
			}
			country_event = { id = redrising.34 days = 180 }
		}
	}
	
	option = {
		name = "redrising.33.a"
	}
}

#Reveal

country_event = {
	id = redrising.34
	hide_window = no
	is_triggered_only = yes
	
	title = rising.34
	desc = rising.34.desc
	picture = GFX_evt_cybernetics

	immediate = {
		redrising_grab_red_species = yes
		if = { limit =	{	has_valid_civic = civic_redrising_noble_lie
							has_country_flag = redrising_society
							any_owned_pop = {
								is_enslaved = yes
							}
							NOT = { has_modifier = redrising_red_rising }
						}
		}
	}

	option = {
		name = "redrising.34.a"
		add_modifier = { 
				modifier = redrising_secret_red
				days = -1
			}
	}
}

#Phobos Address

country_event = {
	id = redrising.35
	hide_window = no
	is_triggered_only = yes
	
	title = rising.35
	desc = rising.35.desc
	picture = GFX_evt_redrising_phobos_address

	immediate = {
		if = {
			limit = {
				is_country_type = default
				num_owned_planets > 2
				NOT = { 
				has_country_flag = redrising_no_rising
				}		
				has_valid_civic = civic_redrising_noble_lie
				has_country_flag = redrising_society
				any_owned_pop = {
					is_enslaved = yes
				}
			}

			country_event = { id = redrising.36 days = 15 }
		}
		else = {
			country_event = { id = redrising.363 days = 15 }
		}
	}

	option = {
		name = "redrising.35.a"
	}
}

#Open War

country_event = {
	id = redrising.36
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		save_global_event_target_as = redrising_current_pre_rising_society
		set_country_flag = no_machine_uprising
		set_country_flag = redrising_no_rising
		if = {
			limit = { 
				any_owned_planet = {
					any_owned_pop = {
						is_enslaved = yes
					}
					is_capital = no
					exists = sector
				}
			}
			random_owned_planet = {
				limit = {
					any_owned_pop = {
						is_enslaved = yes
					}
					is_capital = no
					exists = sector
				}
				planet_event = { id = redrising.361 }
			}
		}
			else = {
				if = {
					limit = {
						any_owned_planet = {
							any_owned_pop = {
								is_enslaved = yes
							}
							is_capital = no
						}
					}
					random_owned_planet = {
						limit = {
							any_owned_pop = {
								is_enslaved = yes
							}
							is_capital = no
						}
						planet_event = { id = redrising.361 }
					}
				}
					else = { # random sector
						if = {
							limit = {
								any_owned_planet = {
									is_capital = no
									exists = sector
								}
							}
							random_owned_planet = {
								limit = {
									is_capital = no
									exists = sector
								}
								planet_event = { id = redrising.361 }
							}
						}
							else = { # random core
								random_owned_planet = {
									limit = {
										is_capital = no
									}
									planet_event = { id = redrising.361 }
								}
							}						
					}				
			}		
	}
}

country_event = {
	id = redrising.363
	title = rising.48
	desc = redrising.363.desc
	picture = GFX_evt_interior_battle

	is_triggered_only = yes

	option = {
		name = EXCELLENT
		hidden_effect = {
			country_event = { id = redrising.381 days = 10 }
		}
	}
}

planet_event = { #rising
	id = redrising.361
	title = rising.36
	picture = GFX_evt_ground_combat
	show_sound = event_ground_battle
	is_triggered_only = yes
	
	desc = {
		trigger = { event_target:redrising_current_pre_rising_society = {has_country_flag = redrising_obsidians_deployed }}
		text = rising.36.desc
	}
	desc = {
		trigger = { NOT = { event_target:redrising_current_pre_rising_society = { has_country_flag = redrising_obsidians_deployed }}}
		text = rising.36.2.desc
	}
	
	option = {
		name = "redrising.36.a"
		custom_tooltip = redrising.36.a.tooltip
		#stay
	}

	option = {
		name = "redrising.36.b"
		custom_tooltip = redrising.36.b.tooltip
		hidden_effect = {
			event_target:redrising_current_rising = {
				set_player = event_target:redrising_the_rising_originator
			}
		}
	}

	immediate = {
		event_target:redrising_current_pre_rising_society = {
			redrising_grab_red_species = yes
		}
		event_target:redrising_current_pre_rising_society = {
			country_event = {
				id = redrising.51
				days = 5
			}	
		}		
		owner = { save_event_target_as = redrising_the_rising_originator }
		set_planet_flag = redrising_rising_capital@root.owner
		# event lock all fleets to prevent exploits
		owner = { every_owned_fleet = { set_event_locked = yes } }
		# find and flag planets
		owner = {
			effect_on_blob = {
				center = root.solar_system
				owned_planets_percentage = 0.5
				planet_limit = {
					OR = {
						controller = { is_same_value = root.owner }
						solar_system = {
							exists = starbase
							starbase = { owner = { is_same_value = root.owner } }
						}
					}
					solar_system = {
						NOT = {
							is_same_value = root.owner.capital_scope.solar_system  
						}							
					}
				}
				effect = {
					set_star_flag = redrising_rising_system_flip
				}
			}
		}
		# create rising species
		create_species = {
			class = "HUM"
			portrait = "human"
			name = "redrising_species_name_society"
			plural = "redrising_species_plural_society"
			namelist = "HUMAN1"
			traits = {
				trait = "trait_decadent"
				trait = "trait_wasteful"
				trait = "trait_talented"
				trait = "trait_very_strong"
			}
		}
		# create rising country
				owner = {
					create_country = {
						name = "Solar Republic"
						type = default
						species = last_created_species
						ignore_initial_colony_error = yes
						day_zero_contact = no
						ethos = { ethic = ethic_fanatic_egalitarian
									ethic = ethic_militarist }
						authority = auth_democratic
						origin = origin_separatists
						civics = { civic = "civic_idealistic_foundation" civic = "civic_parliamentary_system" }
						flag = {
							icon={
								category="ornate"
								file="flag_ornate_5.dds"
							}
							background={
								category="backgrounds"
								file="00_solid.dds"
							}
							colors={
								"dark_blue"
								"dark_green"
								"null"
								"null"
							}
						}
						effect = {
							save_event_target_as = redrising_current_rising
							country_event = { id = redrising.362 }
							create_leader = { 
								class = ruler
								species = root.owner_species
								name = "NAME_mustang_leader"
								skill = 3
								set_age = 22
								gender = female
								traits = {
									trait = trait_ruler_deep_connections
									trait = leader_trait_reformer
								}
							}
							assign_leader = last_created_leader
						}
				}

	}
	}
	after = {
		hidden_effect = {
			event_target:redrising_current_rising_originator = {
				every_owned_fleet = {
					set_event_locked = no
				}
			}
		}
	}
}


country_event = {
	id = redrising.362
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# saving uprising and host as event targets
		save_event_target_as = redrising_current_rising
		from.owner = { save_event_target_as = redrising_current_rising_originator }

		# setting flags
		set_country_flag = redrising_rising_country@from.owner
		set_country_flag = redrising_rising_country
		set_country_flag = redrising_republic
		set_relation_flag = {
			who = event_target:redrising_current_rising_originator
			flag = redrising_rising_to_host_flag
		}
		from.owner = {
			set_country_flag = redrising_rising_originator@root
			set_country_flag = redrising_rising_originator
			add_modifier = { 
				modifier = redrising_red_rising
				days = 5000
			}
			set_relation_flag = {
				who = root
				flag = redrising_host_to_rising_flag
			}
		}
		add_modifier = { 
				modifier = redrising_red_rising
				days = 5000
			}

		# setting graphical culture
		set_graphical_culture = event_target:redrising_current_rising_originator

		# establish comms
		every_country = {
			limit = { has_communications = event_target:redrising_current_rising_originator }
			establish_communications_no_message = root
			establish_contact = { who = root location = from }
		}

		# baseline resource stockpile
		add_resource = {
			energy = 20000
			minerals = 20000
			influence = 800
			alloys = 10000
			food = 10000 
			consumer_goods = 5000 
			rare_crystals = 1000
			volatile_motes = 1000
			exotic_gases = 1000
			sr_dark_matter = 100
		}

		add_500_unity_per_year_passed = yes # scripted effect

		# clear new contact opinion modifier
		if = {
			limit = {
				has_opinion_modifier = {
					who = event_target:redrising_current_rising_originator
					modifier = opinion_new_contact
				}
			}
			remove_opinion_modifier = {
				who = event_target:redrising_current_rising_originator
				modifier = opinion_new_contact
			}
		}

		from = {
			# flip military stations
			solar_system = {
				every_fleet_in_system = {
					limit = {
						exists = owner
						owner = { is_same_value = event_target:redrising_current_rising_originator }
						any_owned_ship = { is_ship_class = shipclass_military_station }
					}
					set_owner = root
				}
			}
			set_owner = root
			set_controller = root
			set_capital = yes

			solar_system = {
				if = {
					limit = {
						exists = starbase
					}
					starbase = { set_owner = root }
				}
					else = {
						create_starbase = {
							size = starbase_starport
							module = shipyard
							owner = root
						}
					}
				
			}

			# create armies
			if = {
				limit = { root = { has_country_flag = redrising_obsidians_deployed } }
				while = {
					count = 6
					create_army = {
						owner = root
						type = "assault_army"
						species = event_target:obsidian_redrising
					}
				}
			}
				else = {
					# regular armies
					while = {
						count = 4
						create_army = {
							owner = root
							species = owner_main_species
							type = "assault_army"
						}
					}
				}
			

			# flip remaining flagged planets
			while = {
				count = 100
				limit = {
					any_system = {
						has_star_flag = redrising_rising_system_flip
						exists = starbase
						starbase = {
							owner = { is_same_value = event_target:redrising_current_rising_originator }
						}
					}
				}
				random_system = {
					limit = {
						has_star_flag = redrising_rising_system_flip
						exists = starbase
						starbase = {
							owner = { is_same_value = event_target:redrising_current_rising_originator }
						}
					}
					starbase = { set_owner = root }
				}
			}
			event_target:redrising_current_rising_originator = {
				every_owned_planet = {
					limit = {
						solar_system = {
							has_star_flag = redrising_rising_system_flip
						}
					}

					# flip military stations
					solar_system = {
						every_fleet_in_system = {
							limit = {
								exists = owner
								owner = { is_same_value = event_target:redrising_current_rising_originator }
								any_owned_ship = { is_ship_class = shipclass_military_station }
							}
							set_owner = root
						}
					}

					set_planet_flag = been_flipped
					set_owner = root
					set_controller = root

					
			# create armies
			if = {
				limit = { event_target:redrising_current_rising_originator = { has_country_flag = redrising_obsidians_deployed } }
				while = {
					count = 6
					create_army = {
						owner = root
						type = "assault_army"
						species = event_target:obsidian_redrising
					}
				}
			}
				else = {
					# regular armies
					while = {
						count = 4
						create_army = {
							owner = root
							species = owner_main_species
							type = "assault_army"
						}
					}
				}
			
				}
			}
		}

		# get host's technologies
		copy_techs_from = {
			target = event_target:redrising_current_rising_originator
			except = {
				tech_subdermal_stimulation
				tech_neural_implants
				tech_selected_lineages
				tech_capacity_boosters
				tech_akx_worm_1
				tech_akx_worm_2
				tech_akx_worm_3
			}
		}

		# survey host's surveyed planets
		every_galaxy_planet = {
			limit = {
				is_surveyed = {
					who = event_target:redrising_current_rising_originator
					status = yes
				}
			}
			set_surveyed = {
				surveyed = yes
				surveyor = root
			}
		}

		# declare war on host
		declare_war = {
			target = event_target:redrising_current_rising_originator
			name = "NAME_redrising_The_Rising_War"
			attacker_war_goal = "wg_redrising_the_rising"
		}

		# create fleets
		if = {
			limit = { event_target:redrising_current_rising_originator = { has_country_flag = redrising_conspiracy_grows } }
			
			# conspiracy fleets, 70% naval cap
			
			create_fleet_from_naval_cap = 0.1
			random_owned_planet = {
				last_created_fleet = {
					set_location = prev
				}
			}

			create_fleet_from_naval_cap = 0.2
			random_owned_planet = {
				last_created_fleet = {
					set_location = prev
				}
			}

			create_fleet_from_naval_cap = 0.4
			random_owned_planet = {
				last_created_fleet = {
					set_location = root.capital_scope
				}
			}
		}
			# regular fleets, 40% naval cap
			else = {
				create_fleet_from_naval_cap = 0.1
				random_owned_planet = {
					last_created_fleet = {
						set_location = prev
					}
				}
				create_fleet_from_naval_cap = 0.3
				random_owned_planet = {
					last_created_fleet = {
						set_location = prev
					}
				}
			}

		# add modifier for AI, including 10x naval cap
		if = {
			limit = { is_ai = yes }
			add_modifier = {
				modifier = uprising_ai_buff
				days = 1800
			}
		}
		# add modifier for player, 10x naval cap
		else = {
			add_modifier = {
				modifier = uprising_player_buff
				days = 1800
			}
		}		

		#science
		create_fleet = {
			effect = {
				set_owner = root

				create_ship = {
					name = random
					random_existing_design = science
				}

				set_fleet_stance = evasive				
				set_location = root.capital_scope
				
				owner = {
					create_leader = {
						class = scientist
						sub_type = survey
						name = random
						species = owner_main_species
					}
				}
				set_leader = last_created_leader
			}			
		}
			
		#constructor
		create_fleet = {
			effect = {
				set_owner = root
				
				create_ship = {
					name = random
					random_existing_design = constructor
				}
				
				set_fleet_stance = evasive
				set_location = root.capital_scope
			}
		}

		country_event = {
			id = redrising.52
			days = 14
		}

		every_owned_fleet = {
			#limit = { event_locked = yes }
			set_event_locked = no
		}
	}
}

#War ends -Republic victory
#This = destroyed country
#From = optional, destroyer (country)

country_event = {
	id = redrising.37
	hide_window = yes
	fire_only_once = no
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = redrising_society
	}

	immediate = {		
		redrising_grab_red_species = yes
		save_event_target_as = DestroyedSociety
		if = {			
			limit = {
				any_country = {					
					has_country_flag = redrising_republic
					reverse_has_relation_flag = {
						who = event_target:DestroyedSociety
						flag = redrising_host_to_rising_flag
					}
				}
			}
			random_country = {
				limit = {
					has_country_flag = redrising_republic
					reverse_has_relation_flag = {
						who = event_target:DestroyedSociety
						flag = redrising_host_to_rising_flag
					}
				}
				remove_country_flag = redrising_rising_originator
				country_event = {
					id = redrising.371
				}
				remove_relation_flag = {
					who = event_target:DestroyedSociety
					flag = redrising_host_to_rising_flag
				}				
			}
		}
	} 
} 

country_event = {
	id = redrising.371
	hide_window = no
	is_triggered_only = yes
	
	title = rising.37
	desc = rising.37.desc
	picture = GFX_evt_victorious_army
	
	trigger = {
		has_country_flag = redrising_republic
	}

	immediate = {
		remove_modifier = redrising_red_rising
		add_modifier = {
				modifier = redrising_red_risen
				days = 1800
		}
	}

	option = {
		name = "redrising.37.a"
	}
}

#War ends -Society victory
#This = destroyed country
#From = optional, destroyer (country)

country_event = {
	id = redrising.38
	hide_window = yes
	fire_only_once = no
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = redrising_republic
	}

	immediate = {		
		save_event_target_as = DestroyedRepublic
		if = {			
			limit = {
				any_country = {					
					has_country_flag = redrising_society
					reverse_has_relation_flag = {
						who = event_target:DestroyedRepublic
						flag = redrising_rising_to_host_flag
					}
				}
			}
			random_country = {
				limit = {
					has_country_flag = redrising_society
					reverse_has_relation_flag = {
						who = event_target:DestroyedRepublic
						flag = redrising_rising_to_host_flag
					}
				}
				remove_country_flag = redrising_rising_country
				country_event = {
					id = redrising.381
				}
				remove_relation_flag = {
					who = event_target:DestroyedRepublic
					flag = redrising_rising_to_host_flag
				}				
			}
		}
	} 
} 

country_event = {
	id = redrising.381
	hide_window = no
	is_triggered_only = yes
	
	title = rising.38
	desc = rising.38.desc
	picture = GFX_evt_victorious_army
	
	trigger = {
		has_country_flag = redrising_society
	}

	immediate = {
			remove_modifier = redrising_red_rising
			remove_modifier = redrising_secret_red
			add_modifier = { 
				modifier = redrising_red_risen
				days = 1800
			}
	}

	option = {
		name = "redrising.38.a"
	}
}

#On Darrow as Soveriegn

country_event = {
	id = redrising.39
	hide_window = no
	is_triggered_only = yes
	
	trigger = {
		ruler = {
			has_leader_flag = redrising_darrow
		}
	}

	title = rising.39
	desc = {
		trigger = { has_country_flag = redrising_institute_pscarred_built }
		text = rising.39.desc
	}
	desc = {
		trigger = { NOT = { has_country_flag = redrising_institute_pscarred_built } }
		text = rising.39.2.desc
	}
	picture = GFX_evt_galactic_senate

	immediate = {
		redrising_grab_red_species = yes
	}

	option = {
		name = "redrising.39.a"
		ruler = {
			exile_leader_as = redrising_darrow
		}		
		hidden_effect = {	
			set_country_flag = redrising_overthrown_darrow		
			country_event = { id = redrising.46 }
		}
	}

	option = {
		name = "redrising.39.b"
		trigger = {	has_valid_civic = civic_redrising_noble_lie
									has_country_flag = redrising_society
									OR = {
										has_ethic = ethic_fanatic_authoritarian
										has_ethic = ethic_authoritarian
									}
	
		}
		shift_ethic = "ethic_fanatic_egalitarian"
		shift_ethic = "ethic_fanatic_egalitarian"
		change_government = {
			authority = auth_democratic
			civics = {
				civic = civic_idealistic_foundation
				civic = civic_parliamentary_system
			}
		}
		create_leader = {
								class =  ruler
								species = root.owner_species
								name = "NAME_mustang_leader"
								skill = 3
								set_age = 22
								gender = female
								traits = {
									trait = trait_ruler_deep_connections
									trait = leader_trait_reformer
								}
							}		
		hidden_effect = {
			assign_leader = last_created_leader
			every_owned_species = {
				set_citizenship_type = {
					country = root
					type = citizenship_full
				}
				set_military_service_type = {
					country = root
					type = military_service_full
				}
				set_migration_controls = {
					country = root
					type = migration_control_no
				}
				set_living_standard = {
					country = root
					type = living_standard_normal
				}
				set_population_controls = {
					country = root
					type = population_control_no
				}
			}
		}		
	}
}

country_event = {
	id = redrising.40
	hide_window = yes
	fire_only_once = no
	is_triggered_only = yes
	
immediate = {

	if = { limit =	{	has_country_flag = redrising_ares_insurrecting_0
					}
			random_list = {
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_1
					}
						country_event = { id = redrising.25 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_2
					}
						country_event = { id = redrising.26 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_3
					}
						country_event = { id = redrising.27 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_4
					}
						country_event = { id = redrising.28 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_5
					}
						country_event = { id = redrising.29 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
				10 = {
					modifier = {
						factor = 0
						has_country_flag = redrising_ares_insurrecting_6
					}
						country_event = { id = redrising.30 }
						country_event = {	id = redrising.40 days = @timebetweenunresteventsdays random = 300 }
					}
			}
		}
	}
}

country_event = {
	id = redrising.41
	hide_window = no
	fire_only_once = no
	is_triggered_only = yes
	
	title = rising.41
	desc = rising.41.desc
	picture = GFX_evt_galactic_senate
		
	immediate = {
		if = { 
			limit = {
				has_country_flag = redrising_society 
				NOR = {
					has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
				}
			}

			redrising_grab_red_species = yes

			remove_country_flag = redrising_society
			remove_modifier = redrising_institute_pscarred_built
			remove_modifier = redrising_something_wicked
			remove_country_flag = redrising_ares_insurrecting_0
			remove_country_flag = redrising_obsidians_deployed
			remove_country_flag = redrising_greys_deployed
			remove_country_flag = redrising_conspiracy_grows
			remove_country_flag = redrising_discovery_reduces_decadence_set
			remove_country_flag = redrising_board_colony_quest_0
			remove_country_flag = redrising_board_colony_quest_1
			remove_country_flag = redrising_board_colony_quest_2

			end_event_chain = redrising_board_control_chain
			every_owned_pop = {
				remove_modifier = redrising_enlightened
			}

			remove_modifier = redrising_10_decadence
			remove_modifier = redrising_9_decadence
			remove_modifier = redrising_8_decadence
			remove_modifier = redrising_7_decadence
			remove_modifier = redrising_6_decadence
			remove_modifier = redrising_5_decadence
			remove_modifier = redrising_4_decadence
			remove_modifier = redrising_3_decadence
			remove_modifier = redrising_2_decadence
			remove_modifier = redrising_1_decadence
			remove_modifier = redrising_0_decadence

			remove_modifier = redrising_board_greens_deployed
			remove_modifier = redrising_board_silvers_deployed
			remove_modifier = redrising_board_orange_deployed
			remove_modifier = redrising_board_blue_deployed
			remove_modifier = redrising_board_pink_deployed
			remove_modifier = redrising_board_white_deployed
			remove_modifier = redrising_discovery_reduces_decadence

			abort_special_project = {
				type = REDRISING_INSTITUTE_1
			}
			abort_special_project = {
				type = REDRISING_OBSIDIAN_1
			}
			abort_special_project = {
				type = REDRISING_GREY_1
			}
			abort_special_project = {
				type = REDRISING_BOARD_COLONY_STUDY
			}
			abort_special_project = {
				type = REDRISING_BOARD_FLEET_STUDY
			}
			abort_special_project = {
				type = REDRISING_BOARD_LARGE_STUDY
			}
			abort_special_project = {
				type = REDRISING_GREENS
			}
			abort_special_project = {
				type = REDRISING_SILVERS
			}
			abort_special_project = {
				type = REDRISING_ORANGES
			}
			abort_special_project = {
				type = REDRISING_BLUES
			}
			abort_special_project = {
				type = REDRISING_PINKS
			}
			abort_special_project = {
				type = REDRISING_WHITES
			}
			end_situation = situation_redrising_decadence
			end_situation = situation_redrising_the_rising
		}
	}
	
	option = {
		name = "redrising.41.a"
	}
}

country_event = {
	id = redrising.42
	hide_window = yes
	fire_only_once = no
	is_triggered_only = yes
		
	immediate = {
		if = {
			limit =	{
				has_country_flag = redrising_society 
				NOT = { has_country_flag = redrising_darrow_died }
				from = { has_leader_flag = redrising_darrow }
				NOT = { from = { has_leader_flag = redrising_darrow_defected }}
			}
			
			country_event = { id = redrising.33 }			
			if = { 
				limit =	{
					OR = {
						ruler = {					
							has_leader_flag = redrising_darrow
						}
						ruler = {					
							has_leader_flag = redrising_became_soveriegn
						}
					}
				}

			country_event = { id = redrising.46 }			
			}
		}		 
	}
}

country_event = {
	id = redrising.43
	hide_window = yes
	fire_only_once = no
	is_triggered_only = yes
	
	trigger = {
		any_country = {
			has_country_flag = redrising_society 
			NOR = {	has_ethic = ethic_authoritarian
					has_ethic = ethic_fanatic_authoritarian
			}
		}
	}

	immediate = {
		every_country = {
			limit = {
				has_country_flag = redrising_society 
				NOR = {	has_ethic = ethic_authoritarian
						has_ethic = ethic_fanatic_authoritarian
				}
			}
			country_event = { id = redrising.41 }
		}
	}
}

# Triggers country_event for the defender upon victory
# Root = country, planet owner
# From = country, attack leader
# FromFrom = planet
country_event = {
	id = redrising.44
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = { limit = { root = { has_country_flag = redrising_dark_revolt_begun } 
						fromfrom = { has_planet_flag = redrising_dark_revolt }
				}
			fromfrom = { remove_planet_flag = redrising_dark_revolt }
			root = {
			if = { limit =	{ NOT = {
								any_owned_planet = {
									has_planet_flag = redrising_dark_revolt
								}
							}
					}
			country_event = { id = redrising.18 } 
			}
			}
		}
	}
}

country_event = {
	id = redrising.45
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		ruler = { has_leader_flag = redrising_darrow }
	}
	
	immediate = {
		country_event = { id = redrising.39 days = @timetofreedomdays }
		ruler = { 
			set_leader_flag = redrising_became_soveriegn			
		}
	}
}

country_event = {
	id = redrising.46
	hide_window = no
	is_triggered_only = yes
	
	title = rising.46
	picture = GFX_evt_space_funeral

	trigger = {
		NOT = {
			has_country_flag = redrising_darrow_died
		}
	}

	immediate = {
		set_country_flag = redrising_darrow_died
		country_event = { id = redrising.34 days = 180 }
	}

	desc = {
		text = rising.46.desc
		trigger = {
			has_country_flag = redrising_overthrown_darrow
		}
	}

	desc = {
		text = rising.46.2.desc
		trigger = {
			NOT = { has_country_flag = redrising_overthrown_darrow }
		}
	}

	option = {
		name = "redrising.46.b"
	}
}

#removed 47

country_event = {
	id = redrising.48
	is_triggered_only = yes
	hide_window = no

	title = rising.48
	desc = rising.48.desc
	picture = GFX_evt_interior_battle

	option = {
		name = "redrising.48.a"
		hidden_effect = {
			country_event = { id = redrising.18 days = 10 }
		}
	}
}

country_event = {
	id = redrising.50
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_country_flag = redrising_institute_pscarred_built
	}

	immediate = {
		from = {
			if = {
				limit = {
					leader_class = admiral
					num_traits < 3
					NOR = {
						has_leader_flag = has_gained_level_trait
						has_trait = trait_redrising_pscarred_admiral
					}
				}
				random_list = {
					90 = { }
					10 = {
						modifier = {
							factor = 1.5
							has_level = 3
						}
						modifier = {
							factor = 2
							has_level = 4
						}						
						modifier = {
							factor = 3
							has_level > 4
						}
						add_trait = trait_redrising_pscarred_admiral
						set_leader_flag = has_gained_level_trait
						set_timed_leader_flag = { flag = has_gained_trait days = 7 }
						owner = {
							country_event = { id = leader.22 }
						}
					}
				}
			}
			if = {
				limit = {
					leader_class = general
					num_traits < 3
					NOR = {
						has_leader_flag = has_gained_level_trait
						has_trait = trait_redrising_pscarred_general
					}
				}
				random_list = {
					90 = { }
					10 = {
						modifier = {
							factor = 1.5
							has_level = 3
						}
						modifier = {
							factor = 2
							has_level = 4
						}						
						modifier = {
							factor = 3
							has_level > 4
						}
						add_trait = trait_redrising_pscarred_general
						set_leader_flag = has_gained_level_trait
						set_timed_leader_flag = { flag = has_gained_trait days = 7 }
						owner = {
							country_event = { id = leader.24 }
						}
					}
				}
			}			
		}
	}
}

country_event = {
	id = redrising.51
	title = redrising.51
	is_triggered_only = yes
	desc = redrising.51.desc
	picture = GFX_evt_pirate_armada

	trigger = {
		has_country_flag = redrising_society
		NOT = { has_country_flag = redrising_republic }
		has_modifier = redrising_red_rising
		any_owned_leader = {
			has_leader_flag = redrising_darrow
		}		
	}

	immediate = {
		every_owned_leader = {
			limit = {
				has_leader_flag = redrising_darrow
			}
			set_leader_flag = redrising_darrow_defected
			exile_leader_as = redrising_darrow
		}
	}

	option = {
		name = redrising.51.a
	}
}

country_event = {
	id = redrising.52
	title = redrising.52
	is_triggered_only = yes
	desc = redrising.52.desc
	picture = GFX_evt_victorious_army

	trigger = {
		has_country_flag = redrising_republic
		NOT = { has_country_flag = redrising_society }
		NOT = {
			any_owned_leader = {
				has_leader_flag = redrising_darrow
			}	
		}			
	}

	immediate = {
		#credit to walshicus#7684 on discord for this code
		create_fleet = {
			name = "gone"
			effect = {
				set_owner = root
				create_ship = { name = random random_existing_design = science }
				set_leader = redrising_darrow
				save_event_target_as = removeFleet
			}
		}        
		destroy_fleet = {
			target = event_target:removeFleet
			kill_leader = no
			destroy_template = yes
		}
		last_created_leader = {
			set_leader_flag = redrising_darrow
		}
		create_fleet_from_naval_cap = 0.1
		random_country = {
			limit = {
				has_relation_flag = {
					who = ROOT
					flag = redrising_host_to_rising_flag
				}
			}
			save_event_target_as = redrising_intel_host_rising_society
		}
	}

	option = {
		name = EXCELLENT
		add_intel = {
			who = event_target:redrising_intel_host_rising_society
			amount = 50
		}
	}
}